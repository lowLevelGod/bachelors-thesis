\chapter{Introducere}

\section{Inteligenţa artificială}

Este un domeniu de studiu din Informatică, discutat încă din prima jumătate a 
secolului al XX-lea, dar care a devenit popular abia la finalul secolului menţionat 
anterior.

Aceasta are ca scop simularea inteligenţei umane folosind diverşi algoritmi şi 
structuri de date. Există mai multe arii de cercetare în acest domeniu, precum: 
raţionamentul, reprezentarea cunoştinţelor, planificarea, procesarea limbajului 
natural, cât şi învăţarea automată care va fi prezentată detaliat în această lucrare.
Totuşi, obiectivul pe termen lung al cercetătorilor este de a simula inteligenţa 
generală, nu doar părţi specifice din aceasta.

Popularitatea acesteia a început să crească odată cu mărirea spaţiului de stocare,
a puterii de procesare, cât şi cu faptul că sistemele de calcul au devenit mai 
accesibile. 

De asemenea, deşi algoritmii existenţi nu s-au mai îmbunătăţit 
semnificativ, accesul la o cantitate enormă de date în ziua de astăzi, anume 
fenomenul "Big Data", a oferit un sprijin considerabil pentru performanţa 
învăţării inteligenţei artificiale\cite{ai-history}.

În acest domeniu, datele colectate, cât şi calitatea lor au un rol extrem de important.
Oricât de bun ar fi algoritmul propus, în lipsa unor date reprezentative pentru 
problema ce trebuie rezolvată, performanţa va fi îndoielnică. Putem spune că datele 
sunt cele care introduc particularităţile din lumea reală în spaţiul teoretic 
al inteligenţei artificiale.

Prin urmare, se observă că aplicabilitatea inteligenţei artificiale 
a fost împiedicată în principal de considerente practice, nu neapărat teoretice.

Printre succesele recente din domeniu se remarcă AlphaFold, un model 
inventat de DeepMind care prezice structura proteinelor din secvenţele 
de amino acizi, GPT-3 al OpenAI ce poate genera text care să răspundă la 
întrebările utilizatorilor aproape ca o fiinţă umană, dar şi algoritmii 
pentru maşini autonome dezvoltaţi de cei de la Tesla.

Utilizarea inteligenţei artificiale poate reduce costurile asociate 
sarcinilor ce ar necesita efortul unei persoane, dar de multe ori apare şi 
problema eticii, precum în cazul înlocuirii recrutorilor cu un program 
ce selectează candidaţii pentru un loc de muncă în funcţie de anumite 
criterii care nu ar fi întocmai corespunzătoare.

Automatizarea detecţiei anomaliior reprezintă una din posibilele aplicaţii
ale inteligenţei artificiale, subiect ce va fi abordat în această lucrare.

\section{Definiţia anomaliilor}


O \textbf{anomalie} este o entitate ce diferă semnificativ de restul enităţilor din 
setul de date. Definiţia lui Hawkins este urmatoarea\cite{hawkins1980identification}:
\textit{"O anomalie este o observaţie ce deviază atât de mult faţă de restul observaţiilor,
încât să creeze suspiciunea că a fost generată de un mecanism diferit"}.

Datele sunt colectate prin observarea unor procese, de preferat din viaţa reală, 
precum funcţionarea
unui motor sau traficul pe o reţea de calculatoare. În majoritatea timpului, procesele
generează date ce corespund unei derulări normale, dar în anumite cazuri acestea se 
comportă anormal şi astfel apar anomaliile. 

\textit{"Normalitatea"} observaţiilor este definită
de oameni. Algoritmii de învăţare automată pot să semnaleze potenţialele
abateri, dar în final, decizia rămâne a omului.

De asemenea, caracteristicile anomaliilor depind de domeniul 
unde acestea apar. Ce este considerat anomalie în domeniul 
medical, va diferi aproape complet de domeniul finanțelor, 
spre exemplu. 

Mai mult, unele observaţii nici măcar nu 
pot reprezenta comportament anormal în afara unui context 
bine definit sau fără a apărea în prezența altor observaţii
care adunate ar forma o anomalie. Un exemplu de comportament
ce poate fi observat în traficul de date pe o rețea al unei 
organizații ar fi 
conectarea de la distanță pe un anumit calculator. Acest lucru
se întâmplă regulat și nu poate ridica nicio suspiciune de 
cele mai multe ori. Dar în combinație cu o oră târzie de 
accesare, când probabil angajații nu mai sunt la lucru, 
sau cu alte comenzi care sunt folosite succesiv pentru a 
comite un atac cibernetic, o observaţie ce în general 
este complet normală, acum prezintă caracteristici anormale.

Prin urmare, se observă că decizia de a eticheta o observaţie ca fiind anomalie 
sau nu este una dificilă chiar şi pentru un om, iar în combinație cu faptul 
că obţinerea de date ce ar putea fi anormale este de cele mai multe ori costisitoare,
face ca evaluarea sistemelor de detecţie să devină una problematică.


\section{Avantajele învăţării automate}

Când sarcinile ce trebuie îndeplinite periodic, necesare bunei funcţionări a unei 
companii spre exemplu, încep să ocupe o mare parte din timpul oamenilor, apare 
nevoia automatizării. 

În general, soluţiile ce includ stabilirea unui set de reguli
sunt de preferat, datorită simplităţii lor. Un exemplu banal ar fi verificarea 
siguranţei unei parole introduse de utilizator la crearea unui cont pe o platformă
web. Este suficient să verificăm dacă parola are un număr minim precizat de caractere 
sau dacă conţine anumite simboluri ce reduc vulnerabilitatea în faţa unui atac cibernetic.

Din păcate, multe din problemele cu care ne confruntăm nu au soluţii simple, 
\textcolor{blue}{iar 
în unele situaţii, problema este greu de definit, mai ales în lipsa exemplelor, precum 
este cazul detecţiei anomaliilor.}
Aici intervine învăţarea automată ce încearcă să aproximeze posibilul set de reguli, 
prea complex pentru a fi definit, ce ar putea rezolva problema. Am putea spune că 
această tehnică "învaţă" setul de reguli 
din datele puse la dispoziţie, de unde şi denumirea. Evident, o aproximare 
nu are cum să fie perfectă, dar este suficient de bună încât să scutească oamenii de 
o mare parte din treabă. În cazul tranzacţiilor bancare, \textcolor{blue}
{ce s-au efectuat în medie 
de 1.98 de miliarde pe zi la nivel global în 2023}\cite{transactions-per-day}, 
nu este greu de observat că verificarea manuală
de către oameni este imposibilă, iar găsirea unui set simplu de reguli care să 
le caracterizeze din nou este o problemă dificilă. Totuşi, învăţarea automată 
ne poate ajuta să minimizăm fraudele ce trec nedetectate de la milioane la câteva zeci
pe zi.

\section{Caracterizarea anomaliilor nu este viabilă}

Un exemplu ce ilustrează de ce obţinerea de informaţii
despre anomalii este costisitoare ar putea fi activitatea unui
motor defect.

În acest caz, avem 2 variante:
\begin{itemize}
    \item Una dintre ele 
        este să \textbf{simulăm} 
        într-un fel sau altul comportamentul unui motor defectuos, dar 
        se observă că această operaţiune este greu de realizat şi chiar dacă am reuşi 
        să o ducem la capăt, datele colectate nu ar fi autentice şi ar putea duce 
        la o reprezentare incorectă a anomaliilor. \textcolor{blue}{
        De asemenea, simularea
        sabotajului ar necesita identificarea unui algoritm corespunzător, 
        dar acest lucru ar duce de fapt la rezolvarea problemei iniţiale.}

    \item A doua variantă implică \textbf{sabotarea 
        intenţionată} a motorului pentru a obţine datele, dar acest lucru produce un 
        cost prea mare de cele mai multe ori. 
\end{itemize}

Este evident că definirea anomaliei în acest context nu este viabilă, iar 
cazul nu este singular. Tranzacţiile frauduloase ce constituie tema acestei lucrări 
suferă de aceleaşi probleme, ba mai mult, nici măcar nu avem opţiunea de a 
sabota intenţionat derularea normală a tranzacţiilor. De asemenea,
dacă anomaliile apar ca urmare a unor acțiuni cu caracter maliţios,
atunci adversarii responsabili pentru acestea vor încerca să 
evite mecanismele existente de detecţie prin schimbarea 
frecventă a metodelor folosite. Prin urmare, ce era considerat
comportament normal înainte, acum poate indica prezența unui 
atac.


În schimb, 
este mult mai uşor şi cel mai probabil 
implică un cost aproape inexistent, să urmărim activitatea unui motor 
în stare bună de funcţionare şi să folosim datele respective pentru a 
defini ce înseamnă o observaţie normală.

\section{Aplicaţii ale detecţiei anomaliilor}

În aproape toate domeniile apare problema semnalării unor fenomene sau evenimente 
ieşite din comun ce necesită atenţia unei persoane pentru analiză. Mai jos prezentăm
doar câteva din cazurile unde detecţia anomaliilor este necesară, cât şi ce ar 
reprezenta o anomalie pentru fiecare:

\begin{itemize}
    \item \textbf{Fraude financiare}: ne dorim să semnalăm comportamentul ciudat 
    observat într-o serie de tranzacţii, precum activitatea generată de 
    o persoană care foloseşte cardul de credit al altei persoane în mod 
    neautorizat. Această aplicaţie constituie şi obiectul lucrării noastre\cite{financial-fraud}.
    \item \textbf{Intruziune în reţele de calculatoare}: vrem să semnalăm activitatea
    neobişnuită ce poate indica un potenţial atac cibernetic sau accesul 
    neautorizat al unui terţ maliţios\cite{network-traffic}.
    \item \textbf{Controlul calităţii în procesele de fabricaţie}: suntem interesaţi să monitorizăm 
    procesul de producţie pentru a raporta eventualele defecţiuni ce ar afecta 
    calitatea produsului\cite{quality-control}.
    \item \textbf{Domeniul medical}: vrem să identificăm anomalii în analizele de sânge, 
    semnele vitale sau imaginile medicale ale pacientului pentru a depista şi preveni
    anumite afecţiuni\cite{medical-images}.
    \item \textbf{Reţele sociale}: ne dorim să raportăm automat conţinutul postat ce 
    poate include remarci jignitoare, precum comentariile rasiste sau xenofobe,
    astfel fiind de ajutor în moderarea materialului încărcat pe platforme\cite{social-media}. 
\end{itemize}

\section{Anomalii în tranzacţii bancare}

Tranzacţiile fraudulente pot produce pagube financiare majore 
atât instituțiilor responsabile de operaţiunile economice 
efectuate prin intermediul lor, cât și celor care apelează
la respectivele servicii. 

Pe lângă prejudiciul material adus,
fraudele nedetectate deteriorează și reputația băncilor 
ce cad victimă acestui fenomen, iar pe termen lung acestea
pot duce la pierderea potenţialilor clienți.

De asemenea, în urma unor operaţiuni frauduloase ce nu au 
fost prevenite, apar și tulburări ale activității economice
desfășurate, deoarece trebuie investite resurse și timp 
pentru investigarea și soluţionarea problemei. Alte costuri
suplimentare ce mai pot apărea reprezintă procese juridice 
îndreptate împotriva instituției financiare afectate, cât și 
sancțiuni pentru nerespectarea normelor de siguranţă.

Numai Marea Britanie a înregistrat pierderi de peste 1.2 
miliarde de lire sterline în 2022 cu aproape 80\% din fraude
originând din mediul online, conform \textit{UK Finance}
\cite{uk-finance}.

Prin urmare, este nevoie de o soluţie care să poată 
preveni o mare parte din tranzacţiile frauduloase, dacă
nu chiar pe toate și care să nu necesite verificarea manuală
a unui om decât pentru un număr mic de evenimente.


\section{Detecţia anomaliilor vs clasificare clasică}

\subsection{Greşeală comună}

La prima vedere, aceste două probleme par sa coincidă şi ne determină
să ne întrebăm de ce a mai apărut un nou domeniu de cercetare, anume detecţia
anomaliilor, când deja avem la dispoziţie atâtea rezultate utile pentru 
problema clasificării. 

\textcolor{blue}{Clasificarea clasică reprezintă problema 
atribuirii clasei corecte pentru fiecare observaţie din setul de date,
unde clasele ce trebuie identificate sunt bine definite şi de cele mai
multe ori, trasăturile lor se suprapun în mai multe locuri.}

Din păcate, dacă nu cunoaştem numărul de clase ce pot apărea 
sau nu avem un eşantion reprezentativ pentru toate tipurile de clase, fapt ce se 
întâmplă deseori în practică, utilizarea unui clasificator clasic probabil 
nu va oferi rezultate bune. De exemplu, 
în cazul tranzacţiilor bancare, nu putem şti cu certitudine care sunt toate 
tipurile de fraudă ce pot apărea şi nici nu avem un număr suficient de exemple 
pentru a defini măcar tipurile de fraudă pe care le-am identificat până acum.
Prin urmare, este mult mai uşor să modelăm problema în jurul unei singure clase 
de referință, decât să încercăm definirea unei clase adiţionale ce de fapt 
este compusă dintr-o multitudine de subclase necunoscute.

De asemenea, problemele de clasificare de cele mai multe ori presupun 
accesul la etichetele asociate fiecărei observaţii, deci metodele 
supervizate sunt cele mai potrivite aici, \textcolor{blue}{pe acestea bazându-se
şi marile succese ale cercetării din ultimii ani în domeniul învăţării automate.} 
Totuşi, și dacă setul de date 
este etichetat, lucru ce se întâmplă în cel mai bun caz, un clasificator 
clasic ar avea o performanță slabă pentru problema detecției anomaliilor
din cauza dificultății modelării claselor, după cum am menționat și mai sus.

De cele mai multe ori nu vom avea etichetele datelor colectate, sau 
cel puțin nu un număr suficient de mare, 
pentru detecţia anomaliilor, așa că apare nevoia metodelor nesupervizate. 
În realitate, totuşi, este posibil ca în timp să acumulăm măcar câteva etichete, chiar 
dacă la început soluţia este pur nesupervizată, pe care le putem 
exploata folosind metode semi-supervizate care în general au o performanță 
mai bună decât cele menționate anterior.

\subsection{Scopul detecţiei anomaliilor}

Diferenţa constă în faptul că detecţia anomaliilor are la bază \textbf{o singură clasă
de referință}. Observaţia fie aparţine acestei clase, fie aparţine oricărei alte clase 
care este diferită de aceasta din urmă. Multitudinea de "clase diferite" ne indică
faptul că este greu să definim ce înseamnă \textit{"diferit de normal"}, dar este relativ uşor
să definim ce înseamnă \textit{"normal"}.

Un exemplu trivial ar putea fi să detectăm dacă animalul din imagine este un câine sau nu.
În acest caz, normal înseamnă câine, iar anormal înseamnă orice alt animal care nu este
câine. Se observă că este relativ uşor să caracterizăm conceptul de câine, în timp ce 
definirea conceptului de "diferit de câine" este complexă, fapt ce ar pune în dificultate
un clasificator clasic care prin definiţie are nevoie de un număr cunoscut de clase 
cu observaţiile reprezentative aferente.

\subsection{Scopul clasificării clasice}

Această problemă acordă o importanţă \textbf{egală} tuturor categoriilor
implicate, pe când 
eşecul de a semnala o anomalie este în general mult mai dăunător faţă de 
detectarea unei observaţii normale ca fiind anormală. 

Pentru a continua exemplul precedent cu imaginile cu animale, putem reformula problema 
ca de această dată să diferenţiem între pisici şi câini. Deja se vede că ambele clase 
sunt mult mai bine definite şi putem găsi atât trăsături comune, precum nasul, cât şi 
trăsături definitorii, precum mustăţile. Vrem să detectăm la fel de bine ambele animale, 
pe când într-o problemă clasică de detecţie a anomaliilor, precum identificarea 
tranzacţiilor frauduloase, vrem preponderent să nu ratăm evenimentele cu 
caracter maliţios.

\section{Probleme conexe pentru detecţia anomaliilor}

\subsection{Outlier detection}

\textbf{Outlier detection} are scopul de a identifica observaţii fie noi,
fie previzibile, din setul de antrenare, care deviază de la 
comportamentul normal. 
\textbf{Outliers} pot fi valori extreme, erori cauzate 
de zgomot, posibil din instrumentele de măsură sau senzorii folosiţi 
pentru colectarea datelor, sau comportament anormal.

Această abordare este utilă atunci când avem un set de date \textbf{"poluat"} cu 
observaţii anormale şi ne dorim să extragem din el doar porţiunea ce conţine 
observaţii deviante. De asemenea, se poate folosi atât pe seturi adnotate, cât 
şi pe seturi fără etichete.

\subsection{Novelty detection}

\textbf{Novelty detection} are scopul de a identifica observaţii noi 
ce diferă semnificativ de datele de antrenare care au rolul de a 
caracteriza cât mai bine clasa normală. Din acest motiv, este foarte 
important ca setul de antrenare să nu conţină
decât date normale pentru a putea identifica caracteristicile clasei de referință,
astfel modelând comportamentul normal.

Prin urmare, această abordare este utilă atunci cand avem un 
set de date \textbf{"curat"} (fără 
anomalii) şi ne aşteptăm ca observaţiile noi să fie rare şi să aibă trăsături
distincte faţă de setul de antrenare. De asemenea, se presupune că datele sunt adnotate 
pentru a putea extrage punctele cu eticheta normală şi să le folosim la antrenare.

\textbf{Novelty detection} este problema pe care o vom studia detaliat în 
această lucrare.

\subsection{Change detection}

\textbf{Change detection} este folosit atunci când dorim să găsim anomalii 
într-o serie de timp, anume să analizăm dacă 
comportamentul seriei se schimbă semnificativ. De obicei, suntem interesați 
ori doar să aflăm dacă o schimbare a apărut, ori să aflăm pozițiile 
în timp unde schimbările respective au avut loc.

Aici se remarcă 2 categorii, \textbf{offline}, 
unde presupunem că avem la dispoziţie 
o serie de timp de lungime finită pe care o analizăm cu scopul de a 
detecta puncte anormale, și \textbf{online}, unde avem un flux de date din 
care vrem să extragem, în timp real, punctele problematice. Deși este probabil 
impropriu, putem considera pentru seriile de timp, intuitiv, că outlier detection este similar 
cu cazul offline din change detection, iar novelty detection este asemănător 
cu cel online din această problemă.

În această lucrare, nu vom aborda problema change detection.